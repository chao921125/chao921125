import{A,b as N,C as B,o as j,e as z}from"./vendor.b99b632f.js";import{T as E}from"./TileImage.0ebee0ae.js";import{c1 as W,c2 as D,E as k,bW as H,bZ as K,c3 as C,Q as X,b3 as Y,c4 as w,V as O,c5 as M,q as F,o as G,w as Z,ae as $,c6 as q,c0 as Q,c7 as U,b$ as R,bX as J,ab as ee,M as te,bY as ae}from"./ol.bb58850a.js";import{_ as ie}from"./index.8bb5b140.js";import{O as L}from"./OSM.7622e957.js";import{O as oe,a as ne}from"./Overlay.1f873668.js";import"./XYZ.0d304f3a.js";var V=globalThis&&globalThis.__extends||function(){var n=function(i,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])},n(i,t)};return function(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),b=.75,f=.1,re=function(n){V(i,n);function i(){return n!==null&&n.apply(this,arguments)||this}return i.prototype.createRenderer=function(){return new W(this)},i}(D),se=function(n){V(i,n);function i(t){var e=this,a=t||{};e=n.call(this,{element:document.createElement("div"),render:a.render,target:a.target})||this,e.boundHandleRotationChanged_=e.handleRotationChanged_.bind(e),e.collapsed_=a.collapsed!==void 0?a.collapsed:!0,e.collapsible_=a.collapsible!==void 0?a.collapsible:!0,e.collapsible_||(e.collapsed_=!1),e.rotateWithView_=a.rotateWithView!==void 0?a.rotateWithView:!1,e.viewExtent_=void 0;var o=a.className!==void 0?a.className:"ol-overviewmap",r=a.tipLabel!==void 0?a.tipLabel:"Overview map",s=a.collapseLabel!==void 0?a.collapseLabel:"\u2039";typeof s=="string"?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=s):e.collapseLabel_=s;var v=a.label!==void 0?a.label:"\u203A";typeof v=="string"?(e.label_=document.createElement("span"),e.label_.textContent=v):e.label_=v;var l=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=r,p.appendChild(l),p.addEventListener(k.CLICK,e.handleClick_.bind(e),!1),e.ovmapDiv_=document.createElement("div"),e.ovmapDiv_.className="ol-overviewmap-map",e.view_=a.view,e.ovmap_=new re({view:a.view});var d=e.ovmap_;a.layers&&a.layers.forEach(function(_){d.addLayer(_)});var c=document.createElement("div");c.className="ol-overviewmap-box",c.style.boxSizing="border-box",e.boxOverlay_=new oe({position:[0,0],positioning:ne.CENTER_CENTER,element:c}),e.ovmap_.addOverlay(e.boxOverlay_);var u=o+" "+H+" "+K+(e.collapsed_&&e.collapsible_?" "+C:"")+(e.collapsible_?"":" ol-uncollapsible"),h=e.element;h.className=u,h.appendChild(e.ovmapDiv_),h.appendChild(p);var m=e,T=e.boxOverlay_,S=e.boxOverlay_.getElement(),I=function(_){return{clientX:_.clientX,clientY:_.clientY}},y=function(_){var g=I(_),P=d.getEventCoordinateInternal(g);T.setPosition(P)},x=function(_){var g=d.getEventCoordinateInternal(_);m.getMap().getView().setCenterInternal(g),window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",x)};return S.addEventListener("mousedown",function(){window.addEventListener("mousemove",y),window.addEventListener("mouseup",x)}),e}return i.prototype.setMap=function(t){var e=this.getMap();if(t!==e){if(e){var a=e.getView();a&&this.unbindView_(a),this.ovmap_.setTarget(null)}if(n.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(X(t,Y.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var o=t.getView();o&&(this.bindView_(o),o.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}},i.prototype.handleMapPropertyChange_=function(t){if(t.key===w.VIEW){var e=t.oldValue;e&&this.unbindView_(e);var a=this.getMap().getView();this.bindView_(a)}else!this.ovmap_.isRendered()&&(t.key===w.TARGET||t.key===w.SIZE)&&this.ovmap_.updateSize()},i.prototype.bindView_=function(t){if(!this.view_){var e=new O({projection:t.getProjection()});this.ovmap_.setView(e)}t.addChangeListener(M.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()},i.prototype.unbindView_=function(t){t.removeChangeListener(M.ROTATION,this.boundHandleRotationChanged_)},i.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},i.prototype.validateExtent_=function(){var t=this.getMap(),e=this.ovmap_;if(!(!t.isRendered()||!e.isRendered())){var a=t.getSize(),o=t.getView(),r=o.calculateExtentInternal(a);if(!(this.viewExtent_&&F(r,this.viewExtent_))){this.viewExtent_=r;var s=e.getSize(),v=e.getView(),l=v.calculateExtentInternal(s),p=e.getPixelFromCoordinateInternal(G(r)),d=e.getPixelFromCoordinateInternal(Z(r)),c=Math.abs(p[0]-d[0]),u=Math.abs(p[1]-d[1]),h=s[0],m=s[1];c<h*f||u<m*f||c>h*b||u>m*b?this.resetExtent_():$(l,r)||this.recenter_()}}},i.prototype.resetExtent_=function(){var t=this.getMap(),e=this.ovmap_,a=t.getSize(),o=t.getView(),r=o.calculateExtentInternal(a),s=e.getView(),v=Math.log(b/f)/Math.LN2,l=1/(Math.pow(2,v/2)*f);q(r,l),s.fitInternal(Q(r))},i.prototype.recenter_=function(){var t=this.getMap(),e=this.ovmap_,a=t.getView(),o=e.getView();o.setCenterInternal(a.getCenterInternal())},i.prototype.updateBox_=function(){var t=this.getMap(),e=this.ovmap_;if(!(!t.isRendered()||!e.isRendered())){var a=t.getSize(),o=t.getView(),r=e.getView(),s=this.rotateWithView_?0:-o.getRotation(),v=this.boxOverlay_,l=this.boxOverlay_.getElement(),p=o.getCenterInternal(),d=o.getResolution(),c=r.getResolution(),u=a[0]*d/c,h=a[1]*d/c;if(v.setPosition(p),l){l.style.width=u+"px",l.style.height=h+"px";var m="rotate("+s+"rad)";l.style.transform=m}}},i.prototype.updateBoxAfterOvmapIsRendered_=function(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=U(this.ovmap_,ee.POSTRENDER,function(t){delete this.ovmapPostrenderKey_,this.updateBox_()},this))},i.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},i.prototype.handleToggle_=function(){this.element.classList.toggle(C),this.collapsed_?R(this.collapseLabel_,this.label_):R(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var t=this.ovmap_;if(!this.collapsed_){if(t.isRendered()){this.viewExtent_=void 0,t.render();return}t.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}},i.prototype.getCollapsible=function(){return this.collapsible_},i.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},i.prototype.setCollapsed=function(t){!this.collapsible_||this.collapsed_===t||this.handleToggle_()},i.prototype.getCollapsed=function(){return this.collapsed_},i.prototype.getRotateWithView=function(){return this.rotateWithView_},i.prototype.setRotateWithView=function(t){this.rotateWithView_!==t&&(this.rotateWithView_=t,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},i.prototype.getOverviewMap=function(){return this.ovmap_},i.prototype.render=function(t){this.validateExtent_(),this.updateBox_()},i}(J),le=se;const pe={id:"map",class:"map__x"},ve={setup(n){const i=A(),t=N(null);function e(){t.value=new te({target:"map",layers:[new E({source:new L})],view:new O({projection:"EPSG:4326",center:[114.064839,22.548857],zoom:12}),controls:ae().extend([new le({className:"ol-overviewmap ol-custom-overviewmap",layers:[new E({source:new L({url:"https://{a-c}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=0e6fc415256d4fbb9b5166a718591d71"})})],collapseLabel:"\xBB",label:"\xAB",collapsed:!1})])})}return B(()=>{i.commit("setComponentPath","src/views/OpenLayers/Basic/pages/OverviewMap/OverviewMap.vue"),e()}),(a,o)=>(j(),z("div",pe))}};var ge=ie(ve,[["__scopeId","data-v-33c74a39"]]);export{ge as default};
